<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TaskSnacks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <!-- Top bar: About + Refresh (always visible) -->
    <div class="top-bar">
      <button id="aboutBtn" class="about-btn" type="button">
        About TaskSnacks
      </button>

      <div class="top-bar-right">
        <button id="refreshBtn" class="cute-refresh" type="button">
          Refresh
        </button>

        <!-- Settings menu trigger -->
        <div class="settings-wrapper">
          <button id="settingsBtn" class="settings-btn" type="button">
            ‚öô
          </button>

          <!-- Small dropdown menu -->
          <div id="settingsMenu" class="settings-menu hidden">
            <button id="changePasswordBtn" type="button" class="settings-item">
              Change my password
            </button>
            <button id="deleteAccountBtn" type="button" class="settings-item danger-item">
              Delete my account
            </button>
          </div>
        </div>
      </div>
    </div>

    <h1>TaskSnacks</h1>
    <p class="subtitle">
      Dump your messy thoughts. Get clear tasks. Earn a fun little reward.
    </p>

    <!-- Auth section -->
    <div id="authSection">
      <input id="emailInput" type="email" placeholder="Email" />
      <input id="passwordInput" type="password" placeholder="Password" />
      <button id="signupBtn" type="button">Sign up</button>
      <button id="loginBtn" type="button">Log in</button>
      <button id="logoutBtn" type="button" style="display:none;">Log out</button>
      <p id="authStatus" class="auth-status"></p>
    </div>
    
    <!-- Password reset section (only used when coming from the email link) -->
    <div id="passwordResetSection" style="display:none; margin-top:16px;">
      <p>Set a new password for your TaskSnacks account.</p>
      <input
        id="newPasswordInput"
        type="password"
        placeholder="New password"
        style="margin-top:8px; padding:8px; border-radius:8px; border:1px solid #e5e7eb; width:100%; max-width:260px;"
      />
      <button
        id="setNewPasswordBtn"
        type="button"
        style="margin-top:8px;"
      >
        Update password
      </button>
    </div>
    
<!-- Everything below is only visible when logged in -->
<div id="appContent" style="display:none;">

  <!-- Calendar -->
  <div id="calendarSection" class="calendar-section">
  <div class="calendar-header">
    <div class="calendar-nav">
      <button id="prevMonthBtn" type="button">‚Äπ</button>
      <span id="calendarMonthLabel" class="calendar-month-label">Month Year</span>
      <button id="nextMonthBtn" type="button">‚Ä∫</button>
    </div>
    <button id="calendarToggleBtn" type="button" class="calendar-toggle-btn">
      Hide calendar
    </button>
  </div>
  <div id="calendarGrid" class="calendar-grid"></div>
</div>

  <!-- Sort controls -->
  <div id="sortSection" class="sort-section">
    <label for="sortMode">Sort tasks:</label>
    <select id="sortMode">
      <option value="priority">By importance (High ‚Üí Low)</option>
      <option value="custom">My order</option>
      <option value="created">By creation time</option>
    </select>
  </div>

  <!-- Hidden date input used by JS -->
  <input id="taskDate" type="date" style="display:none;" />

  <!-- Brain dump -->
  <textarea
    id="brainDump"
    placeholder="Type everything on your mind..."
  ></textarea>
  <!-- Try-before-login hint -->
<p id="tryAIPreviewHint" class="try-ai-hint" style="display:none;">
  ‚ú® Try TaskSnacks AI for free ‚Äî no account needed!  
  Type your messy thoughts above, tap <strong>Organize My Mess</strong>,  
  and see your clean to-do list instantly.  
  Want to save tasks? <strong>Create a free account.</strong>
</p>
  <button id="organizeBtn" type="button">Organize My Mess</button>

  <!-- Manual add -->
  <div id="manualAddSection" class="manual-add">
    <input
      id="manualTaskInput"
      type="text"
      placeholder="Add a task manually..."
    />
    <button id="manualAddBtn" type="button">Add</button>
  </div>

  <!-- Tasks + fun fact -->
  <div id="tasksContainer"></div>
  <div id="funFactContainer" class="fun-fact"></div>

  <!-- Ko-fi (kept but hidden for now) -->
  <div class="coffee" style="display:none;">
    <a href="https://ko-fi.com/tasksnacks" target="_blank" rel="noopener">
      Support TaskSnacks
    </a>
  </div>

  <!-- Undo bar for delete -->
  <div id="undoBar" class="undo-bar">
    <span id="undoText">Task deleted</span>
    <button id="undoBtn" type="button">Undo</button>
  </div>
</div> <!-- /#appContent -->

<!-- About section shown only when logged out -->
<div id="loggedOutInfo" class="logged-out-info" style="display:none;">
  <h2>Welcome to TaskSnacks</h2>
  <p>
    Most productivity apps are packed with boards, labels, and complicated workflows.
    TaskSnacks takes a different approach. It is built for people with busy schedules,
    creative minds, or anyone who simply wants a calmer way to stay organized.
  </p>
  <p>
    Just write your thoughts naturally. You can type fast, messy, out of order, with
    spelling mistakes, it does not matter. TaskSnacks uses AI to instantly turn your
    brain-dump into a small list of structured, clear tasks.
  </p>
  <p>
    Each time you complete a task, you receive a small fun fact. It is a gentle,
    dopamine-friendly reward that helps you stay motivated without pressure.
  </p>
  <p>
    Sign up to experience a lighter, simpler way of planning your day.
  </p>
</div> 
  </div> <!-- /.container -->

  <!-- About modal (visible whether logged in or not) -->
  <div id="aboutModal" class="modal hidden">
    <div id="aboutBackdrop" class="modal-backdrop"></div>
    <div class="modal-dialog">
      <button id="aboutCloseBtn" class="modal-close" type="button">&times;</button>
      <h2>About TaskSnacks</h2>
      <p>
        Most to-do apps are cluttered with boards, tags, and settings. They expect you
        to be organized before you can get organized. TaskSnacks was created for people
        who have busy minds, ADHD brains, or just too much going on.
      </p>
      <p>
        Instead of forcing you to structure everything, TaskSnacks lets you brain-dump
        your entire day in natural language. You can write however you think, with
        spelling mistakes, half sentences, or scattered ideas. The built-in AI turns
        that messy text into 3‚Äì7 clear, ordered tasks that match the flow of your day.
      </p>
      <p>
        Preparation steps come before the main action. Morning tasks come before
        afternoon and evening tasks. You see only what actually matters for today.
      </p>
      <p>
        To keep motivation high, each completed task triggers a small fun-fact reward.
        It is a gentle, dopamine-friendly nudge that makes finishing tasks feel a bit
        more satisfying, without turning your day into a game.
      </p>
      <p>
        Right now TaskSnacks is in an early refinement stage: the core loop is stable
        and we are collecting feedback, improving mobile interactions, and polishing
        the overall experience. The goal is simple: a calm, friendly tool that helps
        you move from mental clutter to clear action, one small task at a time.
      </p>
    </div>
  </div>

  <!-- Delete account modal -->
  <div id="deleteModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <button id="deleteCloseBtn" class="modal-close" type="button">&times;</button>
      <h2>Delete your account</h2>
      <p>
        This will permanently delete your TaskSnacks account and all your tasks.
        This action cannot be undone.
      </p>
      <p style="margin-top:8px;">
        Type <strong>DELETE</strong> to confirm.
      </p>
      <input
        id="deleteConfirmInput"
        type="text"
        placeholder="Type DELETE to confirm"
        style="margin-top:8px; width:100%; padding:8px; border-radius:8px; border:1px solid #e5e7eb;"
      />
      <button
        id="finalDeleteBtn"
        type="button"
        class="danger-item"
        style="margin-top:12px;"
        disabled
      >
        Delete my account
      </button>
    </div>
  </div>

  <!-- Goodbye popup -->
  <div id="goodbyeModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <h2>Goodbye üëã</h2>
      <p>
        Your account and all your data have been deleted.
        See you another time.
      </p>
    </div>
  </div>

  <!-- Supabase client -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

  <!-- Your app logic -->
  <script src="script.js"></script>
</body>
</html>

